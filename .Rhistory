remotes::install_github("tpemartin/econR", force=T)
remotes::install_github("tpemartin/econR", force=T)
library(shiny)
ui = readRDS("ui.RDS")
runApp('shiny')
remotes::install_github("tpemartin/econR", force=T)
remotes::install_github("tpemartin/rmd2drake", force=T)
library(econR)
rstudioapi::initializeProject(. %//% 'mainpage') # to create .Rproj
web$browse()
library(readr)
business10906 <- read_csv("data/8life/business10906.csv")
View(business10906)
business10906 <- read_csv("data/8life/business10906.csv", locale = locale(encoding = "big5"))
business10906 <- read_csv("data/8life/business10906.csv", locale = locale(encoding = "big5"))
business10906 <- read_csv("data/8life/business10906.csv")
business10906 <- read_csv("/Users/tim/Documents/GitHub/interactive_dv_final/data/8life/business10906.csv", locale = locale(encoding = "big5"))
View(business10906)
remotes::install_github("tpemartin/econR", force=T)
install.packages("drake")
remotes::install_github("tpemartin/rmd2drake", force=T)
remotes::install_github("tpemartin/econR", force=T)
remotes::install_github("tpemartin/econR", force=T)
install.packages("dplyr")
install.packages(c("ggplot2", "shiny"))
install.packages("remote")
install.packages("remotes")
remotes::install_github("tpemartin/econR", force=T)
library(econR)
initiateProjectAtCurrentRmd()
install.packages("rstudioapi")
library(econR)
initiateProjectAtCurrentRmd()
library(ggplot2)
library(dplyr)
remove.packages("stats")
library(dplyr)
install.packages("stats")
install.packages("stats")
library(readxl)
faraway_109 <- read_excel("data/school/faraway_109.xls")
View(faraway_109)
list_epivars()
library(ggplot2)
library(dplyr)
library(readxl)
faraway_109 <- read_excel("data/school/faraway_109.xls",
col_names = FALSE, skip = 3)
View(faraway_109)
library(readxl)
library(stringr)
faraway_109[[1,]]
faraway_109[1,]
faraway_109 <- read_excel("data/school/faraway_109.xls",
col_names = FALSE, skip = 3,,
col_types = c("text", "skip", "text",
"text", "text", "text", "text", "text",
"text", "text", "text", "text", "text",
"text", "text", "text", "text", "text",
"text"))
faraway_109[1,]
str_c(faraway_109[1,],faraway_109[2,])
str_replace_na(faraway_109[1,],"")
str_c(
str_replace_na(faraway_109[1,],""),
str_replace_na(faraway_109[2,],""),)
str_c(
str_replace_na(faraway_109[1,],""),
str_replace_na(faraway_109[2,],""))
install.packages("styler")
library(ggplot2)
library(dplyr)
library(readxl)
library(stringr)
library(sysfonts)
library(showtext)
font_add("QYuan","cwTeXQYuan-Medium.ttf") # 新增字體
showtext_auto(enable=TRUE) #啟用字體
faraway_109 <- read_excel("support/data/school/faraway_109.xls",
col_names = FALSE, skip = 3, #skip first three rows
col_types = c("text", "skip", "text",  #skip unneeded columns
"text", "text", "text", "skip", "text",
"text", "text", "text", "text", "text",
"skip", "skip", "text", "text", "skip",
"skip"))
# change colnames
str_c(
str_replace_na(faraway_109[1,],""),
str_replace_na(faraway_109[2,],"")
) -> colnames109
colnames(faraway_109) <- colnames109
# remove first two rows (they are the original colname subparts )
faraway_109[-c(1,2),] -> faraway_109
faraway_109[is.na(faraway_109$地區屬性),]
which(is.na(faraway_109$地區屬性))
faraway_109[-which(is.na(faraway_109$地區屬性)),] -> faraway_109
unique(faraway_109$縣市名稱)
#分離代碼和縣市名稱
faraway_109 %>% mutate(
縣市代碼=str_sub(縣市名稱,2,3),
縣市名稱=str_sub(縣市名稱,5,)
) -> faraway_109
schoolfiles <- list.files(path = "./support/data/school", pattern = "*.xls", all.files = T, full.names = T)
schoolfiles <- sapply(schoolfiles,read_xls)
faraway_109 <- read_excel("support/data/school/faraway_109.xls",
col_names = FALSE, skip = 3, #skip first three rows
col_types = c("text", "skip", "text",  #skip unneeded columns
"text", "text", "text", "skip", "text",
"text", "text", "text", "text", "text",
"skip", "skip", "text", "text", "skip",
"skip"))
# change colnames
str_c(
str_replace_na(faraway_109[1,],""),
str_replace_na(faraway_109[2,],"")
) -> colnames109
colnames(faraway_109) <- colnames109
# remove first two rows (they are the original colname subparts )
faraway_109[-c(1,2),] -> faraway_109
faraway_109[is.na(faraway_109$地區屬性),]
which(is.na(faraway_109$地區屬性))
faraway_109[-which(is.na(faraway_109$地區屬性)),] -> faraway_109
schoolfiles <- list.files(path = "./support/data/school", pattern = "*.xls", all.files = T, full.names = T)
schoollist <- sapply(schoolfiles,read_xls)
str_sub(schoolfiles,23,33)
names(schoollist) <- str_sub(schoolfiles,23,33)
schoollist$faraway_109 <- read_excel("support/data/school/faraway_109.xls",
col_names = FALSE, skip = 3, #skip first three rows
col_types = c("text", "skip", "text",  #skip unneeded columns
"text", "text", "text", "skip", "text",
"text", "text", "text", "text", "text",
"skip", "skip", "text", "text", "skip",
"skip"))
schoollist$faraway_109 <- read_excel("support/data/school/faraway_109.xls",
col_names = FALSE, skip = 3, #skip first three rows
col_types = c("text", "skip", "text",  #skip unneeded columns
"text", "text", "text", "skip", "text",
"text", "text", "text", "text", "text",
"skip", "skip", "text", "text", "skip",
"skip"))
# change colnames
str_c(
str_replace_na(faraway_109[1,],""),
str_replace_na(faraway_109[2,],"")
) -> colnames109
colnames(faraway_109) <- colnames109
# remove first two rows (they are the original colname subparts )
faraway_109[-c(1,2),] -> faraway_109
View(schoollist)
faraway_109[is.na(faraway_109$地區屬性),]
schoollist$faraway_109[is.na(faraway_109$地區屬性),]
schoollist$faraway_109[is.na(schoollist$faraway_109$地區屬性),]
is.na(schoollist$faraway_109$地區屬性)
schoollist$faraway_109 <- read_excel("support/data/school/faraway_109.xls",
col_names = FALSE, skip = 3, #skip first three rows
col_types = c("text", "skip", "text",  #skip unneeded columns
"text", "text", "text", "skip", "text",
"text", "text", "text", "text", "text",
"skip", "skip", "text", "text", "skip",
"skip"))
# change colnames
str_c(
str_replace_na(faraway_109[1,],""),
str_replace_na(faraway_109[2,],"")
) -> colnames109
colnames(faraway_109) <- colnames109
# remove first two rows (they are the original colname subparts )
faraway_109[-c(1,2),] -> faraway_109
colnames(schoollist$faraway_109)
schoollist$faraway_109 <- read_excel("support/data/school/faraway_109.xls",
col_names = FALSE, skip = 3, #skip first three rows
col_types = c("text", "skip", "text",  #skip unneeded columns
"text", "text", "text", "skip", "text",
"text", "text", "text", "text", "text",
"skip", "skip", "text", "text", "skip",
"skip"))
# change colnames
str_c(
str_replace_na(schoollist$faraway_109[1,],""),
str_replace_na(schoollist$faraway_109[2,],"")
) -> colnames109
colnames(schoollist$faraway_109) <- colnames109
# remove first two rows (they are the original colname subparts )
schoollist$faraway_109[-c(1,2),] -> schoollist$faraway_109
schoollist$faraway_109[is.na(schoollist$faraway_109$地區屬性),]
which(is.na(schoollist$faraway_109$地區屬性))
schoollist$faraway_109[-which(is.na(schoollist$faraway_109$地區屬性)),] -> faraway_109
unique(schoollist$faraway_109$縣市名稱)
#分離代碼和縣市名稱
schoollist$faraway_109 %>% mutate(
縣市代碼=str_sub(縣市名稱,2,3),
縣市名稱=str_sub(縣市名稱,5,)
) -> schoollist$faraway_109
View(schoollist)
str_sub(schoolfiles,23,33)
str_sub(schoolfiles,23,33)[3:8]
schoollist[3:8]
schoollist[[3:8]]
schoollist[3]
schoollist[[3]]
schoollist$faraway_101
schoollist[[3]] %>% class()
schoollist[3] %>% class()
schoollist1 <- schoollist[[3:8]] # 103~108
schoollist[3][c(1,2),]
schoollist[[3][c(1,2),]
schoollist[[3]][c(1,2),]
schoollist[[3]]
for (i in 3:8){
schoollist[[i]][-c(1,2),] ->  schoollist[[i]] #頭兩排NA
str_c(
str_replace_na(schoollist[[i]][1,],""),
str_replace_na(schoollist[[i]][2,],"")
) -> colnames_temp
colnames(schoollist[[i]]) <- colnames_temp
schoollist[[i]][-c(1,2),] ->  schoollist[[i]]
}
for (i in 3:8){
schoollist[[i]][-c(1,2),] ->  schoollist[[i]] #頭兩排NA
str_c(
str_replace_na(schoollist[[i]][1,],""),
str_replace_na(schoollist[[i]][2,],"")
) -> colnames_temp
colnames(schoollist[[i]]) <- colnames_temp
schoollist[[i]][-c(1,2),] ->  schoollist[[i]]
}
View(schoollist)
schoolfiles <- list.files(path = "./support/data/school", pattern = "*.xls", all.files = T, full.names = T)
schoollist <- sapply(schoolfiles,read_xls) #101~109年
names(schoollist) <- str_sub(schoolfiles,23,33)
schoollist$faraway_109 <- read_excel("support/data/school/faraway_109.xls",
col_names = FALSE, skip = 3, #skip first three rows
col_types = c("text", "skip", "text",  #skip unneeded columns
"text", "text", "text", "skip", "text",
"text", "text", "text", "text", "text",
"skip", "skip", "text", "text", "skip",
"skip"))
# change colnames
str_c(
str_replace_na(schoollist$faraway_109[1,],""),
str_replace_na(schoollist$faraway_109[2,],"")
) -> colnames109
colnames(schoollist$faraway_109) <- colnames109
# remove first two rows (they are the original colname subparts )
schoollist$faraway_109[-c(1,2),] -> schoollist$faraway_109
schoollist$faraway_109[is.na(schoollist$faraway_109$地區屬性),]
which(is.na(schoollist$faraway_109$地區屬性))
schoollist$faraway_109[-which(is.na(schoollist$faraway_109$地區屬性)),] -> faraway_109
unique(schoollist$faraway_109$縣市名稱)
#分離代碼和縣市名稱
schoollist$faraway_109 %>% mutate(
縣市代碼=str_sub(縣市名稱,2,3),
縣市名稱=str_sub(縣市名稱,5,)
) -> schoollist$faraway_109
for (i in 3:8){
schoollist[[i]][-c(1,2),] ->  schoollist[[i]] #頭兩排NA
str_c(
str_replace_na(schoollist[[i]][1,],""),
str_replace_na(schoollist[[i]][2,],"")
) -> colnames_temp
colnames(schoollist[[i]]) <- colnames_temp
schoollist[[i]][-c(1,2),] ->  schoollist[[i]]
}
View(schoollist)
colnames(schoollist$faraway_109)[-14]
for (i in 1:length(schoollist)){
# schoollist[[i]] %>% mutate(
#   縣市代碼=str_sub(縣市名稱,2,3),
#   縣市名稱=str_sub(縣市名稱,5,)
# ) -> schoollist[[i]]
# -> Can't transform a data frame with duplicate names.
# 因為colnames在剛才重新命名後有重複的
#先取出需要的欄位，剛好撇除那些重複的colnames
schoollist[[i]] %>% select(colnames(schoollist$faraway_109)[-14]) -> schoollist[[i]]
schoollist[[i]] %>% mutate(
縣市代碼=str_sub(縣市名稱,2,3),
縣市名稱=str_sub(縣市名稱,5,)
) -> schoollist[[i]]
}
for (i in 3:8){
# schoollist[[i]] %>% mutate(
#   縣市代碼=str_sub(縣市名稱,2,3),
#   縣市名稱=str_sub(縣市名稱,5,)
# ) -> schoollist[[i]]
# -> Can't transform a data frame with duplicate names.
# 因為colnames在剛才重新命名後有重複的
#先取出需要的欄位，剛好撇除那些重複的colnames
schoollist[[i]] %>% select(colnames(schoollist$faraway_109)[-14]) -> schoollist[[i]]
schoollist[[i]] %>% mutate(
縣市代碼=str_sub(縣市名稱,2,3),
縣市名稱=str_sub(縣市名稱,5,)
) -> schoollist[[i]]
}
View(schoollist)
